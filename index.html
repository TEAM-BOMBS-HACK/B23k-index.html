<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Webhook Controller</title>
<style>
body {
    background:#0f1220;
    font-family: Arial;
    color:#fff;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}
.box {
    background:#1a1f3c;
    padding:20px;
    border-radius:12px;
    width:360px;
    box-shadow:0 0 20px #000;
}
h2 {
    text-align:center;
    margin-bottom:15px;
}
input, textarea, button {
    width:100%;
    margin-top:10px;
    padding:10px;
    border:none;
    border-radius:8px;
    outline:none;
}
textarea { resize:none; height:80px; }
button {
    background:#5865f2;
    color:white;
    cursor:pointer;
}
button.stop {
    background:#ff4d4d;
}
small {
    opacity:0.7;
}
</style>
</head>
<body>

<div class="box">
    <h2>Webhook Control</h2>

    <input id="webhook" placeholder="Webhook URL">
    <textarea id="message" placeholder="Message content"></textarea>

    <input id="count" type="number" placeholder="عدد التكرار">
    <input id="delay" type="number" placeholder="التأخير (ms)">

    <button onclick="start()">Start Send</button>
    <button class="stop" onclick="stop()">Stop</button>

    <small id="status"></small>
</div>

<script>
let running = false;

async function start(){
    const url = document.getElementById("webhook").value;
    const msg = document.getElementById("message").value;
    const count = parseInt(document.getElementById("count").value);
    const delay = parseInt(document.getElementById("delay").value);

    if(!url || !msg || !count || !delay){
        alert("كمل كل الحقول");
        return;
    }

    running = true;
    document.getElementById("status").innerText = "Running...";

    for(let i=0;i<count;i++){
        if(!running) break;

        await fetch(url,{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify({content: msg})
        });

        document.getElementById("status").innerText =
            `تم الإرسال ${i+1}/${count}`;

        await new Promise(r=>setTimeout(r,delay));
    }

    running = false;
    document.getElementById("status").innerText = "Done.";
}

function stop(){
    running = false;
    document.getElementById("status").innerText = "Stopped.";
}
</script>

</body>
</html>
